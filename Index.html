<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="author" content="Consultor de implantaÃ§Ã£o Erick Rocha" />
  <title>Gerador de Chave NF-e</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f3f4f6;
      margin: 0;
      padding: 2rem;
    }
    h1 {
      color: #1f2937;
      text-align: center;
    }
    form {
      background: #fff;
      padding: 1.5rem;
      max-width: 600px;
      margin: 0 auto;
      border-radius: 8px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.05);
    }
    label {
      display: block;
      margin: 1rem 0 0.3rem;
    }
    input {
      width: 100%;
      padding: 0.6rem;
      border: 1px solid #ccc;
      border-radius: 4px;
    }
    button {
      margin-top: 1rem;
      padding: 0.6rem 1.5rem;
      background: #3b82f6;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    button:hover {
      background: #2563eb;
    }
    #saida {
      background: #e5e7eb;
      padding: 1rem;
      white-space: pre-wrap;
      margin: 1rem auto;
      max-width: 600px;
      border-radius: 8px;
      font-family: monospace;
    }
    #baixarXML {
      display: none;
      background: #10b981;
    }
    #baixarXML:hover {
      background: #059669;
    }
  </style>
</head>
<body>
  <h1>Gerador de Chaves NF-e (Modelo 55)</h1>

  <form id="formulario">
    <label>UF (cUF):</label>
    <input type="text" name="cUF" value="41" required />
    <label>MÃªs/Ano (AAMM):</label>
    <input type="text" name="AAMM" value="2505" required />
    <label>CNPJ (14 dÃ­gitos):</label>
    <input type="text" name="CNPJ" required />
    <label>SÃ©rie:</label>
    <input type="text" name="serie" value="001" required />
    <label>Modelo:</label>
    <input type="text" name="modelo" value="55" required />
    <label>Tipo de EmissÃ£o (1=Normal):</label>
    <input type="text" name="tpEmis" value="1" required />
    <label>Quantidade de chaves:</label>
    <input type="number" name="quantidade" value="1" min="1" required />
    <button type="submit">Gerar Chaves</button>
    <button type="button" id="baixarXML">ðŸ“¦ Baixar XML</button>
  </form>

  <pre id="saida"></pre>

  <script>
    function calcularDV(chave43) {
      let peso = 2, soma = 0;
      for (let i = 42; i >= 0; i--) {
        soma += parseInt(chave43[i]) * peso;
        peso = peso < 9 ? peso + 1 : 2;
      }
      const resto = soma % 11;
      return (resto === 0 || resto === 1) ? "0" : (11 - resto).toString();
    }

    function padLeft(str, length) {
      return str.toString().padStart(length, "0");
    }

    function gerarChave(dados, numero, cNF) {
      const nNF = padLeft(numero, 9);
      const chave43 =
        dados.cUF +
        dados.AAMM +
        dados.CNPJ +
        dados.modelo +
        padLeft(dados.serie, 3) +
        nNF +
        dados.tpEmis +
        padLeft(cNF, 8);
      return chave43 + calcularDV(chave43);
    }

    document.getElementById("formulario").addEventListener("submit", function (e) {
      e.preventDefault();
      const form = e.target;
      const dados = {
        cUF: padLeft(form.cUF.value, 2),
        AAMM: padLeft(form.AAMM.value, 4),
        CNPJ: padLeft(form.CNPJ.value.replace(/\D/g, ""), 14),
        serie: padLeft(form.serie.value, 3),
        modelo: padLeft(form.modelo.value, 2),
        tpEmis: form.tpEmis.value,
        quantidade: parseInt(form.quantidade.value),
      };

      if (dados.CNPJ.length !== 14) {
        alert("CNPJ deve conter 14 dÃ­gitos.");
        return;
      }

      const chaves = [];
      for (let i = 1; i <= dados.quantidade; i++) {
        const cNF = Math.floor(10000000 + Math.random() * 89999999);
        chaves.push(gerarChave(dados, i, cNF));
      }

      document.getElementById("saida").textContent =
        `ðŸ”‘ ${dados.quantidade} chave(s) gerada(s):\n\n` + chaves.join("\n");
      document.getElementById("baixarXML").style.display = "inline-block";
    });

    function gerarNFeXML(chaves) {
      let xml = `<?xml version="1.0" encoding="UTF-8"?>\n<listaNFe>\n`;
      chaves.forEach(chave => {
        xml += `
  <NFe xmlns="http://www.portalfiscal.inf.br/nfe">
    <infNFe versao="4.00" Id="NFe${chave}">
      <ide>
        <cUF>${chave.slice(0, 2)}</cUF>
        <cNF>${chave.slice(35, 43)}</cNF>
        <natOp>VENDA</natOp>
        <mod>${chave.slice(20, 22)}</mod>
        <serie>${parseInt(chave.slice(22, 25))}</serie>
        <nNF>${parseInt(chave.slice(25, 34))}</nNF>
        <dhEmi>${new Date().toISOString()}</dhEmi>
        <tpNF>1</tpNF>
        <idDest>1</idDest>
        <tpEmis>${chave[34]}</tpEmis>
        <tpAmb>2</tpAmb>
        <finNFe>1</finNFe>
        <indFinal>1</indFinal>
        <indPres>1</indPres>
        <procEmi>0</procEmi>
        <verProc>1.0</verProc>
      </ide>
      <emit>
        <CNPJ>${chave.slice(6, 20)}</CNPJ>
        <xNome>Empresa Exemplo LTDA</xNome>
        <enderEmit>
          <xLgr>Rua das Notas</xLgr>
          <nro>123</nro>
          <xBairro>Centro</xBairro>
          <cMun>4106902</cMun>
          <xMun>Curitiba</xMun>
          <UF>PR</UF>
          <CEP>80000000</CEP>
          <cPais>1058</cPais>
          <xPais>Brasil</xPais>
        </enderEmit>
        <IE>1234567890</IE>
        <CRT>3</CRT>
      </emit>
      <dest>
				<CNPJ>77856995000111</CNPJ>
				<xNome>NF-E EMITIDA EM AMBIENTE DE HOMOLOGACAO - SEM VALOR FISCAL</xNome>
				<enderDest>
					<xLgr>AV. INDEPENDENCIA</xLgr>
					<nro>1729</nro>
					<xBairro>CENTRO</xBairro>
					<cMun>4117909</cMun>
					<xMun>Palotina</xMun>
					<UF>PR</UF>
					<CEP>85950000</CEP>
					<cPais>1058</cPais>
					<xPais>Brasil</xPais>
				</enderDest>
				<indIEDest>1</indIEDest>
				<IE>4140011229</IE>
			</dest>
			<det nItem="1">
				<prod>
					<cProd>504</cProd>
					<cEAN>SEM GTIN</cEAN>
					<xProd>PRODUTO FERTILIZANTE 5L</xProd>
					<NCM>31059090</NCM>
					<CFOP>5102</CFOP>
					<uCom>L</uCom>
					<qCom>100.0000</qCom>
					<vUnCom>50.0000000000</vUnCom>
					<vProd>5000.00</vProd>
					<cEANTrib>SEM GTIN</cEANTrib>
					<uTrib>L</uTrib>
					<qTrib>50.0000</qTrib>
					<vUnTrib>50.0000000000</vUnTrib>
					<indTot>1</indTot>
				</prod>
				<imposto>
					<vTotTrib>0.00</vTotTrib>
					<ICMS>
						<ICMS51>
							<orig>0</orig>
							<CST>51</CST>
							<modBC>3</modBC>
							<pRedBC>0.0000</pRedBC>
							<vBC>0.00</vBC>
							<pICMS>0.0000</pICMS>
							<vICMSOp>0.00</vICMSOp>
							<pDif>100.0000</pDif>
							<vICMSDif>0.00</vICMSDif>
							<vICMS>0.00</vICMS>
						</ICMS51>
					</ICMS>
					<PIS>
						<PISNT>
							<CST>06</CST>
						</PISNT>
					</PIS>
					<COFINS>
						<COFINSNT>
							<CST>06</CST>
						</COFINSNT>
					</COFINS>
				</imposto>
				<infAdProd>Lote: ALI020156, Qnt: 50.0, Val: 28/05/2027;   Formula: ALI020156, N. Reg. Prod.:  ALI020156, N. Reg. Fab.:  ALI020156;</infAdProd>
			</det>
			<total>
				<ICMSTot>
					<vBC>0.00</vBC>
					<vICMS>0.00</vICMS>
					<vICMSDeson>0.00</vICMSDeson>
					<vFCPUFDest>0.00</vFCPUFDest>
					<vICMSUFDest>0.00</vICMSUFDest>
					<vICMSUFRemet>0.00</vICMSUFRemet>
					<vFCP>0.00</vFCP>
					<vBCST>0.00</vBCST>
					<vST>0.00</vST>
					<vFCPST>0.00</vFCPST>
					<vFCPSTRet>0.00</vFCPSTRet>
					<vProd>8524.00</vProd>
					<vFrete>0.00</vFrete>
					<vSeg>0.00</vSeg>
					<vDesc>0.00</vDesc>
					<vII>0.00</vII>
					<vIPI>0.00</vIPI>
					<vIPIDevol>0.00</vIPIDevol>
					<vPIS>0.00</vPIS>
					<vCOFINS>0.00</vCOFINS>
					<vOutro>0.00</vOutro>
					<vNF>8524.00</vNF>
					<vTotTrib>0.00</vTotTrib>
				</ICMSTot>
			</total>
			<transp>
				<modFrete>9</modFrete>
				<vol>
					<pesoL>50.000</pesoL>
					<pesoB>50.000</pesoB>
				</vol>
			</transp>
			<cobr>
				<fat>
					<nFat>5576</nFat>
					<vOrig>8524.00</vOrig>
					<vLiq>8524.00</vLiq>
				</fat>
				<dup>
					<nDup>001</nDup>
					<dVenc>2025-07-17</dVenc>
					<vDup>8524.00</vDup>
				</dup>
			</cobr>
			<pag>
				<detPag>
					<indPag>1</indPag>
					<tPag>05</tPag>
					<vPag>8524.00</vPag>
				</detPag>
			</pag>
			<infAdic>
				<infCpl>ITEM 504: Diferimento do ICMS conforme artigo</infCpl>
			</infAdic>
			<infRespTec>
				<CNPJ>02435301000173</CNPJ>
				<xContato>Fernando de Souza Faria</xContato>
				<email>fernando.faria@hubconexa.com</email>
				<fone>6232671500</fone>
			</infRespTec>
		</infNFe>
		<Signature xmlns="http://www.w3.org/2000/09/xmldsig#">
			<SignedInfo>
				<CanonicalizationMethod Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315"/>
				<SignatureMethod Algorithm="http://www.w3.org/2000/09/xmldsig#rsa-sha1"/>
				<Reference URI="#NFe41250521280419000114550010000055811017344982">
					<Transforms>
						<Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
						<Transform Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315"/>
					</Transforms>
					<DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"/>
					<DigestValue>WPUS73PKQw74dmZhYBCP2aUd+RU=</DigestValue>
				</Reference>
			</SignedInfo>
			<SignatureValue>BVwsYcjWkpZr98UEzeQjoh7jkvoWQ4TaNl2kCwOVw0m9ZGSzMeqtIbFExG2q4WGENDHpeTljCbRiylS0NYz+PVjT88tDuWzJpz/rJPSvnLRbpi3YUrWl2t0n2t7vfoOAHNU60VbdU1isloC9jA5NEdra6kPQaFKld243k3YNPz01VH8BUkmtYumN3kzuDsrWIygHJlBqKDgn5YDbchButu/1YiPVMhxdsY0+SFR9AlRjgWWLcuIQBz60RTU+INCjcLt9gKJnEsOfpn9/SSFBeXUJPtxhgKwJkoTL/mq3v9A1A+4hRL/eqTuky8P9J00pATL2vJTLJTFDjlXHz/nYJg==</SignatureValue>
			<KeyInfo>
				<X509Data>
					<X509Certificate>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</X509Certificate>
				</X509Data>
			</KeyInfo>
		</Signature>
	</NFe>`;
      });
      return xml + "\n</listaNFe>";
    }

    document.getElementById("baixarXML").addEventListener("click", function () {
      const chaves = document.getElementById("saida").textContent
        .split("\n")
        .filter(l => /^\d{44}$/.test(l));

      const xmlContent = gerarNFeXML(chaves);
      const blob = new Blob([xmlContent], { type: "application/xml" });
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = "notas-nfe.xml";
      a.click();
      URL.revokeObjectURL(url);
    });
  </script>

    <footer style="text-align:center; margin-top:2rem; color:#666; font-size:0.9rem;">
    Desenvolvido por <strong>Consultor de implantaÃ§Ã£o Erick Rocha</strong>
  </footer>
  
</body>
</html>
